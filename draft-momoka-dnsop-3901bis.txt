



dnsop                                            山本 桃歌 (M. Yamamoto)
Internet-Draft                      The University of Tokyo/WIDE Project
Intended status: Informational                           19 October 2023
Expires: 21 April 2024


               DNS IPv6 Transport Operational Guidelines
                   draft-momoka-dnsop-3901bis-latest

Abstract

   This memo provides guidelines and Best Current Practice for operating
   DNS in a world where queries and responses are carried in a mixed
   environment of IPv4 and IPv6 networks.

Discussion Venues

   This note is to be removed before publishing as an RFC.

   Source for this draft and an issue tracker can be found at
   https://github.com/momoka0122y/draft-dnsop-3901bis.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 21 April 2024.

Copyright Notice

   Copyright (c) 2023 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.

Table of Contents

   1.  Introduction
   2.  Terminology
   3.  Name Space Fragmentation: following the referral chain
   4.  Policy Based Avoidance of Name Space Fragmentation
     4.1.  Guidelines for Authoritative Name Servers
       4.1.1.  Reasons for Broken IPv6 Delegation
     4.2.  Guidelines for DNS Resolvers
   5.  Security Considerations
   6.  IANA Considerations
   Acknowledgments
   References
     Normative References
     Informative References
   Author's Address

1.  Introduction

   Today, the Internet is a mixture of IPv4 and IPv6 networks.  This
   creates a complex landscape where authoritative name servers might be
   accessible only via specific network protocols.  This poses a
   challenge for resolvers that are limited to using either IPv4 or
   IPv6, as they might encounter unreachable servers during the name
   resolution process.

   Ideally, making DNS data accessible over both IPv4 and IPv6 is the
   most robust and flexible approach, as it allows resolvers to reach
   the information they need without requiring intermediary translation
   or forwarding services.

2.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP
   14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

   DNS terminology is as described in [RFC8499].

   The phrase "IPv4 name server" indicates a name server available over
   IPv4 transport.  It does not imply anything about what DNS data is
   served.  Likewise, "IPv6 name server" indicates a name server
   available over IPv6 transport.  The phrase "dual-stack name server"
   indicates a name server that is actually configured to run both
   protocols, IPv4 and IPv6, and not merely a server running on a system
   capable of running both but actually configured to run only one.

3.  Name Space Fragmentation: following the referral chain

   A resolver that tries to look up a name starts out at the root, and
   follows referrals until it is referred to a name server that is
   authoritative for the name.  If somewhere down the chain of referrals
   it is referred to a name server that is only accessible over a
   transport which the resolver cannot use, the resolver is unable to
   finish the task.

   With all DNS data only available over IPv4 transport everything is
   simple.  IPv4 resolvers can use the intended mechanism of following
   referrals from the root and down while IPv6 resolvers have to work
   through a "translator", i.e., they have to use a recursive name
   server on a so-called "dual stack" host as a "forwarder" since they
   cannot access the DNS data directly.

   With all DNS data only available over IPv6 transport everything would
   be equally simple, with the exception of IPv4 recursive name servers
   having to switch to a forwarding configuration.

   The transition from IPv4 only to a mixture of IPv4 and IPv6, with
   three categories of DNS data depending on whether the information is
   available only over IPv4 transport, only over IPv6 or both.

   Having DNS data available on both transports is the optimal
   situation.

4.  Policy Based Avoidance of Name Space Fragmentation

   Today there are a lot DNS "zones" on the public Internet that are
   available over IPv6 transport, and the numbers are growing year by
   year.  However, there are still a lot of "zones" that are not yet
   IPv6 capable so resolvers still need IPv4 connectivity to resolve all
   domain names.

   Having zones served only by IPv6-only name server would not be a good
   development either, since this will fragment the previously
   unfragmented IPv4 name space and there are strong reasons to find a
   mechanism to avoid it.

   The recommended approach to maintain name space continuity is to use
   administrative policies, as described in the next section.

4.1.  Guidelines for Authoritative Name Servers

   IPv4 adoption: Every authoritative DNS zone SHOULD be served by at
   least one IPv4-reachable authoritative name server to maintain name
   space continuity.

   IPv6 Adoption: Authoritative name servers SHOULD aim to be accessible
   via IPv6 to ensure service reliability for IPv6-only resolvers.  It
   is recognized that some networks have not yet adopted IPv6
   connectivity, making this a challenging guideline to implement
   universally.  However, for networks that do have IPv6 capability but
   have not yet configured their authoritative name servers to run on
   IPv6, it is recommended to do so to prevent any disruption in
   services for IPv6-only resolvers.

   Consistency: Both IPv4 and IPv6 transports should serve identical DNS
   data to ensure a consistent resolution experience across different
   network types.

   Note: zone validation processes SHOULD ensure that there is at least
   one IPv4 address record available for the name servers of any child
   delegations within the zone.

4.1.1.  Reasons for Broken IPv6 Delegation

   Even when an administrator thinks they have enabled IPv6 on their
   authoritative name server misconfiguration specific to IPv6 may break
   the DNS delegation chain of a zone and prevent any of its records
   from resolving in an IPv6-only scenario.  These misconfigurations can
   be kept for a long time as resolvers can fallback to IPv4.

   The following misconfigurations can cause broken IPv6-delegation in
   an IPv6-only setting:

   No AAAA records for NS names: If none of the NS records for a zone in
   their parent zone have associated AAAA records, resolution via IPv6
   is not possible.

   Missing GLUE: If the name from an NS record for a zone is in-
   bailiwick, i.e., the name is within the zone or below, a parent zone
   must contain an IPv6 GLUE record, i.e., a parent must serve the
   corresponding AAAA record(s) as ADDITIONAL data when returning the NS
   record in the ANSWER section.

   No AAAA record for in-bailiwick NS : If an NS record of a zone points
   to a name that is in-bailiwick but the name lacks AAAA record(s) in
   its zone, IPv6-only resolution will fail even if the parent provides
   GLUE, when the recursive server validates the delegation path.  One
   such example is Unbound with the setting harden-glue: yes–the
   default.

   Zone of out-of-bailiwick NS es not resolving: If an NS record of a
   zone is out-of-bailiwick, the corresponding zone must be
   IPv6-resolvable as well.  It is insufficient if the name pointed to
   by the NS record has an associated AAAA record.

   Parent zone not IPv6-resolvable: For a zone to be resolvable via IPv6
   the parent zones up to the root zone must be IPv6-resolvable.  Any
   non-IPv6-resolvable zone breaks the delegation chain for all its
   children.

   The above misconfigurations are not mutually exclusive.

4.2.  Guidelines for DNS Resolvers

   Every iterative name server SHOULD be either IPv4-only or dual stack.

   The zones a IPv6-only iterative resolvers can resolve are growing but
   as they cannot fully resolve all zones, they are not advisable at the
   moment.

   While IPv6-only iterative resolvers are not recommended,
   configurations may be designed where such resolvers forward queries
   to a set of dual-stack recursive name servers that perform the actual
   recursive queries.

5.  Security Considerations

   The guidelines described in this memo introduce no new security
   considerations into the DNS protocol or associated operational
   scenarios.

6.  IANA Considerations

   This document has no IANA actions.

Acknowledgments

   TODO: acknowledge people.

   Thank you for reading this draft.

References

Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/rfc/rfc2119>.

Informative References

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/rfc/rfc8174>.

   [RFC8499]  Hoffman, P., Sullivan, A., and K. Fujiwara, "DNS
              Terminology", BCP 219, RFC 8499, DOI 10.17487/RFC8499,
              January 2019, <https://www.rfc-editor.org/rfc/rfc8499>.

Author's Address

   Momoka Yamamoto
   The University of Tokyo/WIDE Project
   Email: momoka.my6@gmail.com

   Additional contact information:

      山本 桃歌
      The University of Tokyo/WIDE Project
